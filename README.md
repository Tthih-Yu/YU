# 安徽工程大学宿舍电费监控系统

这是一个用于实时监控安徽工程大学宿舍电费的Python程序。该系统可以自动获取任意宿舍楼、任意房间的电费余额，并支持数据记录和可视化展示。

## 功能特点

- **全校宿舍支持**：支持全校所有宿舍楼（男生宿舍、女生宿舍、研究生宿舍、梦溪7栋、梦溪7-9栋）
- **实时电费查询**：定时自动查询电费余额
- **数据记录**：将电费数据保存到CSV文件中
- **数据可视化**：生成电费余额趋势图
- **低余额提醒**：当电费余额低于设定阈值时发出提醒

## 安装说明

1. 确保已安装Python 3.7或更高版本
2. 安装依赖包：
```bash
pip install requests pandas matplotlib python-dotenv schedule
```

3. 下载程序文件（main.py、config.py、.env）到同一目录

## 使用方法

### 基本配置

1. 在`.env`文件中设置会话ID（需要从手机APP抓包获取）：
```
JSESSIONID=您的会话ID
```

2. 在`config.py`文件中修改宿舍信息：
```python
# 当前选择的宿舍信息
CURRENT_BUILDING = "女05#楼"  # 在这里修改宿舍楼
ROOM_ID = "324"               # 在这里修改房间号
```

3. 运行主程序：
```bash
python main.py
```

### 切换宿舍楼

如需查询其他宿舍楼的电费，只需在`config.py`中修改`CURRENT_BUILDING`的值。支持的宿舍楼包括：

#### 男生宿舍楼
- 男25#楼、男22#楼、男21#楼、男20#楼、男19#楼、男18#楼、男17#楼、男16#楼
- 男15#楼、男14#楼、男12#楼、男11#楼、男06#楼、男05#楼

#### 女生宿舍楼
- 女13#楼、女12#楼、女11#楼、女10#楼、女09#楼、女08#楼、女07#楼
- 女06#楼、女05#楼、女04#楼、女03#楼、女02#楼、女01#楼

#### 研究生宿舍楼
- 研05#楼、研04#楼、研03#楼、研02#楼、研01#楼

#### 梦溪宿舍楼
- 梦溪7-1栋至梦溪7-8栋
- 梦溪7-9-A栋、梦溪7-9-B栋、梦溪7-9-C栋

### 自定义设置

在`config.py`中可以调整以下参数：

- `CHECK_INTERVAL`：检查电费间隔时间（分钟）
- `LOW_BALANCE_THRESHOLD`：低余额警告阈值（元）
- `NOTIFICATION_THRESHOLD`：通知阈值（元）

## 数据文件

- `electricity_data.csv`：保存查询到的电费数据
- `electricity_trend.png`：电费趋势图

## 注意事项

1. **会话ID更新**：JSESSIONID会定期过期，当程序无法获取电费数据时，需要重新抓包获取新的JSESSIONID并更新`.env`文件
2. **数据准确性**：程序获取的电费数据与校园电费系统保持一致，但系统可能存在延迟
3. **使用频率**：建议不要过于频繁地查询，以免对学校服务器造成负担

## 常见问题

1. **无法获取电费数据？**
   - 检查JSESSIONID是否过期
   - 确认宿舍楼名称和房间号是否正确
   - 检查网络连接是否正常

2. **显示"无法获取房间信息"？**
   - 可能是该房间不存在或未开通电费系统
   - 检查房间号是否正确

3. **提示"未找到宿舍楼"？**
   - 检查`CURRENT_BUILDING`的值是否在`BUILDINGS`字典中

## 技术原理

程序通过模拟安徽工程大学电费查询系统的请求，获取电费数据。主要涉及：
1. 发送POST请求到学校电费系统
2. 解析返回的JSON数据
3. 提取电费余额信息
4. 保存并可视化数据

## 项目贡献与反馈

如发现bug或有改进建议，请联系作者。 
* 人工智能222 万世杰 Q:2190638246